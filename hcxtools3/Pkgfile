# Description:  Capture packets from WLAN devices for hashcat (old version)
# URL:          https://github.com/wi-fi-analyzer/hcxtools
# Maintainer:   Alexandr Savca, drop at chinarulezzz dot fun
# Depends on:   git libpcap

name=hcxtools3
version=3.5.0-$(date +%Y%m%d)
_commit=e4b60f45a1765c745c7acd6098145df167e13a1f
release=1
source=(Makefile.patch)

download_git() {
        if [[ -d $PKGMK_SOURCE_DIR/$name ]]; then
                git -C $PKGMK_SOURCE_DIR/$name fetch --depth=1
                git -C $PKGMK_SOURCE_DIR/$name clean -f
                git -C $PKGMK_SOURCE_DIR/$name reset --hard origin/$2
        else
                git -C $PKGMK_SOURCE_DIR clone --depth=1 $1 -b $2 $name
        fi

	git -C $PKGMK_SOURCE_DIR/$name checkout ${_commit}
        cp  -r $PKGMK_SOURCE_DIR/$name $PKGMK_WORK_DIR/src/$name
}

build() {
	download_git https://github.com/wi-fi-analyzer/${name/3} master
	cd $name

	patch -i $SRC/Makefile.patch

	make CFLAGS="${CFLAGS}" INSTALLDIR=$PKG/usr/bin install
}
