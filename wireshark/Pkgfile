# Description: Network Sniffer
# URL:         http://www.wireshark.org
# Maintainer:  Alexandr Savca, alexandrsavca89 at gmail dot com
# Depends on:  c-ares gnutls hicolor-icon-theme libgcrypt libnl libpcap libpcre2 libssh lz4 qt5 zstd

name=wireshark
version=3.3.1
release=3
source=(https://1.eu.dl.$name.org/src/all-versions/$name-$version.tar.xz)

build() {
	cmake -S$name-$version -Bbuild -GNinja \
		-DCMAKE_INSTALL_PREFIX=/usr                  \
		-DCMAKE_INSTALL_LIBDIR=lib                   \
		-DCMAKE_BUILD_TYPE=Release                   \
		-DCMAKE_C_FLAGS_RELEASE="$CFLAGS -DNDEBUG"   \
		-DCMAKE_CXX_FLAGS_RELEASE="$CXXFLAGS -DNDEBUG"

	cmake --build build -v
	DESTDIR=$PKG cmake --install build

	# Don't remove these files, they are read by wireshark's about box.
	#rm -f $PKG/usr/share/$name/{AUTHORS-SHORT,COPYING}

	rm -r $PKG/usr/share/doc
	rm -r $PKG/usr/share/wireshark/radius/README.radius_dictionary
}
