# Description:  Assemble/disassemble network packets at the protocol level
# URL:          https://metacpan.org/pod/NetPacket
# Maintainer:   Alexandr Savca, drop at chinarulezzz dot fun
# Depends on:   p5-module-build

name=p5-netpacket
version=1.7.2
release=1
source=(https://cpan.metacpan.org/authors/id/Y/YA/YANICK/NetPacket-$version.tar.gz)

build() {
	cd NetPacket-$version

	(
	export PERL_MM_USE_DEFAULT=1 PERL5LIB=""            \
	PERL_AUTOINSTALL=--skipdeps                         \
	PERL_MM_OPT="INSTALLDIRS=vendor DESTDIR='$PKG'"     \
	PERL_MB_OPT="--installdirs vendor --destdir '$PKG'" \
	MODULEBUILDRC=/dev/null

	perl Makefile.PL
	make OPTIMIZE="$CFLAGS"
	)

	make DESTDIR=$PKG install

	find $PKG  -name perllocal.pod  \
		-o -name "*.bs"         \
		-o -name .packlist      \
		-o -name autosplit.ix   \
	| xargs rm -f

	find $PKG -depth -type d -empty -delete
}
