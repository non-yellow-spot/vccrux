# Description: GTK+ email client and news reader
# URL:         http://sylpheed.sraoss.jp/en/
# Maintainer:  Alexandr Savca, alexandrsavca89 at gmail dot com
# Depends on:  gpgme gtk xorg-libxdamage

name=sylpheed
version=3.7.0
release=4
source=(https://sylpheed.sraoss.jp/$name/v${version%.*}/$name-$version.tar.xz
	$name-$version-textview.c.patch
	$name-$version-summaryview.c.patch)

build () {
	cd $name-$version

	# fix widget style for dark themes
	patch src/textview.c $SRC/$name-$version-textview.c.patch

	# fix summary font size for terminus-like fonts
	patch src/summaryview.c $SRC/$name-$version-summaryview.c.patch

	./configure \
		--prefix=/usr             \
		--disable-glibtest        \
		--disable-gtktest         \
		--disable-updatecheck     \
		--disable-updatecheckplugin

	make
	make DESTDIR=$PKG install

	sed -ri '/\[.+\]=/d' $name.desktop

	install -d $PKG/usr/share/{applications,pixmaps}
	install -m 0644 $name.desktop  $PKG/usr/share/applications
	install -m 0644 $name.png      $PKG/usr/share/pixmaps

	rm -r $PKG/usr/share/{locale,sylpheed}
}
